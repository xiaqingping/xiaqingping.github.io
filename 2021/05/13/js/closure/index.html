<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>闭包 - Scott&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Scott_xia"><meta name="msapplication-TileImage" content="https://scott_xia.gitee.io/static-resources/img/header.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Scott_xia"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="[译]发现 JavaScript 中闭包的强大威力"><meta property="og:type" content="article"><meta property="og:title" content="闭包"><meta property="og:url" content="http://scott_xia.gitee.io/2021/05/13/js/closure/"><meta property="og:site_name" content="Scott&#039;s blog"><meta property="og:description" content="[译]发现 JavaScript 中闭包的强大威力"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://scott_xia.gitee.io/blog/images/vector_landscape_1.svg"><meta property="article:published_time" content="2021-05-13T02:42:47.000Z"><meta property="article:modified_time" content="2021-05-13T02:49:24.990Z"><meta property="article:author" content="Scott_xia"><meta property="article:tag" content="js"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://scott_xia.gitee.io/blog/images/vector_landscape_1.svg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://scott_xia.gitee.io/2021/05/13/js/closure/"},"headline":"Scott's blog","image":[],"datePublished":"2021-05-13T02:42:47.000Z","dateModified":"2021-05-13T02:49:24.990Z","author":{"@type":"Person","name":"Scott_xia"},"description":"[译]发现 JavaScript 中闭包的强大威力"}</script><link rel="canonical" href="http://scott_xia.gitee.io/2021/05/13/js/closure/"><link rel="icon" href="https://scott_xia.gitee.io/static-resources/img/header.jpg"><link rel="stylesheet" href="https://at.alicdn.com/t/font_2285034_8c7bvyy7fhj.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://scott_xia.gitee.io/static-resources/img/header.jpg" alt="Scott&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener external nofollow noreferrer" title="Download on GitHub" href="https://github.com/xiaqingping"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://scott_xia.gitee.io/blog/images/vector_landscape_1.svg" alt="闭包"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-05-13T02:42:47.000Z" title="2021/5/13 上午10:42:47">2021-05-13</time>发表</span><span class="level-item"><time dateTime="2021-05-13T02:49:24.990Z" title="2021/5/13 上午10:49:24">2021-05-13</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/js/">js</a></span></div></div><h1 class="title is-3 is-size-4-mobile">闭包</h1><div class="content"><p>[译]发现 JavaScript 中闭包的强大威力</p>
<a id="more"></a>


<blockquote>
<p><strong>原文地址：</strong> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/discover-the-power-of-closures-in-javascript-5c472a7765d7">Discover the power of closures in JavaScript</a><br><strong>原文作者：</strong> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/@cristisalcescu">Cristi Salcescu</a><br><strong>译者：</strong> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wcflmy">wcflmy</a></p>
</blockquote>
<p>闭包是一个可以访问外部作用域的内部函数，即使这个外部作用域已经执行结束。</p>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>作用域决定这个变量的生命周期及其可见性。 当我们创建了一个函数或者 <code>&#123;&#125;</code> 块，就会生成一个新的作用域。需要注意的是，通过 <code>var</code> 创建的变量只有函数作用域，而通过 <code>let</code> 和 <code>const</code> 创建的变量既有函数作用域，也有块作用域。</p>
<h3 id="嵌套作用域"><a href="#嵌套作用域" class="headerlink" title="嵌套作用域"></a>嵌套作用域</h3><p>在 <code>Javascript</code> 中函数里面可以嵌套函数，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    function log()&#123;</span><br><span class="line">       console.log(x);</span><br><span class="line">    &#125;</span><br><span class="line">    log();</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>log()</code> 即是一个嵌套在 <code>autorun()</code> 函数里面的函数。在 <code>log()</code> 函数里面可以通过外部函数访问到变量 <code>x</code>。此时，<code>log()</code> 函数就是一个闭包。</p>
<p>闭包就是内部函数，我们可以通过在一个函数内部或者 <code>&#123;&#125;</code> 块里面定义一个函数来创建闭包。</p>
<h4 id="外部函数作用域"><a href="#外部函数作用域" class="headerlink" title="外部函数作用域"></a>外部函数作用域</h4><p>内部函数可以访问外部函数中定义的变量，即使外部函数已经执行完毕。如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    setTimeout(function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;, 10000);</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>并且，内部函数还可以访问外部函数中定义的形参，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(function autorun(p)&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    setTimeout(function log()&#123;</span><br><span class="line">      console.log(x);&#x2F;&#x2F;1</span><br><span class="line">      console.log(p);&#x2F;&#x2F;10</span><br><span class="line">    &#125;, 10000);</span><br><span class="line">&#125;)(10);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<h4 id="外部块作用域"><a href="#外部块作用域" class="headerlink" title="外部块作用域"></a>外部块作用域</h4><p>内部函数可以访问外部块中定义的变量，即使外部块已执行完毕，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    setTimeout(function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;, 10000);</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<h3 id="词法作用域"><a href="#词法作用域" class="headerlink" title="词法作用域"></a>词法作用域</h3><p>词法作用域是指内部函数在定义的时候就决定了其外部作用域。</p>
<p>看<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/pcg6fab7/">如下</a>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    function run(fn)&#123;</span><br><span class="line">      let x &#x3D; 100;</span><br><span class="line">      fn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    run(log);&#x2F;&#x2F;1</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>log()</code> 函数是一个闭包，它在这里访问的是 <code>autorun()</code> 函数中的 <code>x</code> 变量，而不是 <code>run</code> 函数中的变量。</p>
<blockquote>
<p>闭包的外部作用域是在其定义的时候已决定，而不是执行的时候。</p>
</blockquote>
<p><code>autorun()</code> 的函数作用域即是 <code>log()</code> 函数的词法作用域。</p>
<h3 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h3><p>每一个作用域都有对其父作用域的引用。当我们使用一个变量的时候，<code>Javascript引擎</code> 会通过变量名在当前作用域查找，若没有查找到，会一直沿着作用域链一直向上查找，直到 <code>global</code> 全局作用域。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/udq46asp/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let x0 &#x3D; 0;</span><br><span class="line">(function autorun1()&#123;</span><br><span class="line"> let x1 &#x3D; 1;</span><br><span class="line"></span><br><span class="line"> (function autorun2()&#123;</span><br><span class="line">   let x2 &#x3D; 2;</span><br><span class="line"></span><br><span class="line">   (function autorun3()&#123;</span><br><span class="line">     let x3 &#x3D; 3;</span><br><span class="line"></span><br><span class="line">     console.log(x0 + &quot; &quot; + x1 + &quot; &quot; + x2 + &quot; &quot; + x3);&#x2F;&#x2F;0 1 2 3</span><br><span class="line">    &#125;)();</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>我们可以看到，<code>autorun3()</code> 这个内部函数可以访问其自身局部变量 <code>x3</code> ，也可以访问外部作用域中的 <code>x1</code> 和 <code>x2</code> 变量，以及全局作用域中的 <code>x0</code> 变量。即：闭包可以访问其外部(父)作用域中的定义的所有变量。</p>
<h4 id="外部作用域执行完毕后"><a href="#外部作用域执行完毕后" class="headerlink" title="外部作用域执行完毕后"></a>外部作用域执行完毕后</h4><p>当外部作用域执行完毕后，内部函数还存活（仍在其他地方被引用）时，闭包才真正发挥其作用。譬如以下几种情况：</p>
<ul>
<li>在异步任务例如 <code>timer</code> 定时器，事件处理，<code>Ajax</code> 请求中被作为回调</li>
<li>被外部函数作为返回结果返回，或者返回结果对象中引用该内部函数</li>
</ul>
<p>考虑如下的几个<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/Lmx4zuk0/">示例</a>：</p>
<h4 id="Timer"><a href="#Timer" class="headerlink" title="Timer"></a>Timer</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    setTimeout(function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;, 10000);</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>变量 <code>x</code> 将一直存活着直到定时器的回调执行或者 <code>clearTimeout()</code> 被调用。 如果这里使用的是 <code>setInterval()</code> ，那么变量 <code>x</code> 将一直存活到 <code>clearInterval()</code> 被调用。</p>
<p><em>译者注：原文中说变量 <code>x</code> 一直存活到 <code>setTimeout()</code> 或者 <code>setInterval()</code> 被调用是错误的。</em></p>
<h4 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    $(&quot;#btn&quot;).on(&quot;click&quot;, function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>当变量 <code>x</code> 在事件处理函数中被使用时，它将一直存活直到该事件处理函数被移除。</p>
<h4 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(function autorun()&#123;</span><br><span class="line">    let x &#x3D; 1;</span><br><span class="line">    fetch(&quot;http:&#x2F;&#x2F;&quot;).then(function log()&#123;</span><br><span class="line">      console.log(x);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>变量 <code>x</code> 将一直存活到接收到后端返回结果，回调函数被执行。</p>
<p>在已上几个示例中，我们可以看到，<code>log()</code> 函数在父函数执行完毕后还一直存活着，<code>log()</code> 函数就是一个闭包。</p>
<p>除了 <code>timer</code> 定时器，事件处理，<code>Ajax</code> 请求等比较常见的异步任务，还有其他的一些异步 <code>API</code> 比如 <code>HTML5 Geolocation</code>，<code>WebSockets</code> , <code>requestAnimationFrame()</code>也将使用到闭包的这一特性。</p>
<p>变量的生命周期取决于闭包的生命周期。被闭包引用的外部作用域中的变量将一直存活直到闭包函数被销毁。如果一个变量被多个闭包所引用，那么直到所有的闭包被垃圾回收后，该变量才会被销毁。</p>
<h3 id="闭包与循环"><a href="#闭包与循环" class="headerlink" title="闭包与循环"></a>闭包与循环</h3><p>闭包只存储外部变量的引用，而不会拷贝这些外部变量的值。 查看如下<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/rgszn91t/">示例</a>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function initEvents()&#123;</span><br><span class="line">  for(var i&#x3D;1; i&lt;&#x3D;3; i++)&#123;</span><br><span class="line">    $(&quot;#btn&quot; + i).click(function showNumber()&#123;</span><br><span class="line">      alert(i);&#x2F;&#x2F;4</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">initEvents();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>在这个示例中，我们创建了 3 个闭包，皆引用了同一个变量 <code>i</code>，且这三个闭包都是事件处理函数。由于变量 <code>i</code> 随着循环自增，因此最终输出的都是同样的值。</p>
<p>修复这个问题最简单的方法是在 <code>for</code> 语句块中使用 <code>let</code> 变量声明，这将在每次循环中为 <code>for</code> 语句块创建一个新的局部变量。如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function initEvents()&#123;</span><br><span class="line">  for(let i&#x3D;1; i&lt;&#x3D;3; i++)&#123;</span><br><span class="line">    $(&quot;#btn&quot; + i).click(function showNumber()&#123;</span><br><span class="line">      alert(i);&#x2F;&#x2F;1 2 3</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">initEvents();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>但是，如果变量声明在 <code>for</code> 语句块之外的话，即使用了 <code>let</code> 变量声明，所有的闭包还是会引用同一个变量，最终输出的还是同一个值。</p>
<h3 id="闭包与封装性"><a href="#闭包与封装性" class="headerlink" title="闭包与封装性"></a>闭包与封装性</h3><p>封装性意味着信息隐藏。</p>
<h4 id="函数与私有状态"><a href="#函数与私有状态" class="headerlink" title="函数与私有状态"></a>函数与私有状态</h4><p>通过闭包，我们可以创建拥有私有状态的函数，闭包使得状态被封装起来。</p>
<h4 id="工厂模式与私有原型对象"><a href="#工厂模式与私有原型对象" class="headerlink" title="工厂模式与私有原型对象"></a>工厂模式与私有原型对象</h4><p>我们先来看一个通过原型创建对象的常规方式，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let todoPrototype &#x3D; &#123;</span><br><span class="line">  toString : function() &#123;</span><br><span class="line">    return this.id + &quot; &quot; + this.userName + &quot;: &quot; + this.title;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">function Todo(todo)&#123;</span><br><span class="line">  let newTodo &#x3D; Object.create(todoPrototype);</span><br><span class="line">  Object.assign(newTodo, todo);</span><br><span class="line">  return newTodo;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>在这个例子中，<code>todoPrototype</code> 原型对象是一个全局对象。</p>
<p>我们可以通过闭包，只用创建原型对象一次，也能够被所有 <code>Todo</code> 函数调用所公用，并且保证其私有性。<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/k167vzus/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let Todo &#x3D; (function createTodoFactory()&#123;</span><br><span class="line">  let todoPrototype &#x3D; &#123;</span><br><span class="line">    toString : function() &#123;</span><br><span class="line">      return this.id + &quot; &quot; + this.userName + &quot;: &quot; + this.title;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return function(todo)&#123;</span><br><span class="line">    let newTodo &#x3D; Object.create(todoPrototype);</span><br><span class="line">    Object.assign(newTodo, todo);</span><br><span class="line">    return newTodo;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line">let todo &#x3D; Todo(&#123;id : 1, title: &quot;This is a title&quot;, userName: &quot;Cristi&quot;, completed: false &#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>这里，<code>Todo()</code> 就是一个拥有私有状态的函数。</p>
<h4 id="工厂模式与私有构造函数"><a href="#工厂模式与私有构造函数" class="headerlink" title="工厂模式与私有构造函数"></a>工厂模式与私有构造函数</h4><p>查看<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/uepa7zrg/">如下</a>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let Todo &#x3D; (function createTodoFactory()&#123;</span><br><span class="line"> function Todo(spec)&#123;</span><br><span class="line">   Object.assign(this, spec);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> return function(spec)&#123;</span><br><span class="line">   let todo &#x3D; new Todo(spec);</span><br><span class="line">   return Object.freeze(todo);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>这里，<code>Todo()</code> 工厂函数就是一个闭包。通过它，不管是否使用 <code>new</code> ，我们都可以创建不可变对象，原型对象也只用创建一次，并且它是私有的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let todo &#x3D; Todo(&#123;title : &quot;A description&quot;&#125;);</span><br><span class="line">todo.title &#x3D; &quot;Another description&quot;;</span><br><span class="line">&#x2F;&#x2F; Cannot assign to read only property &#39;title&#39; of object</span><br><span class="line">todo.toString &#x3D; function() &#123;&#125;;</span><br><span class="line">&#x2F;&#x2F;Cannot assign to read only property &#39;toString&#39; of object</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>而且，在内存快照中，我们可以通过构造函数名来识别这些示例对象。</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/1/28/16893554bf659a7f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Memory snapshot in Chrome DevTools"></p>
<h4 id="翻译功能与私有-map"><a href="#翻译功能与私有-map" class="headerlink" title="翻译功能与私有 map"></a>翻译功能与私有 map</h4><p>通过闭包，我们可以创建一个 <code>map</code>，在所有翻译调用中被使用，且是私有的。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/04Luda6f/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let translate &#x3D; (function()&#123;</span><br><span class="line">  let translations &#x3D; &#123;&#125;;</span><br><span class="line">  translations[&quot;yes&quot;] &#x3D; &quot;oui&quot;;</span><br><span class="line">  translations[&quot;no&quot;]  &#x3D; &quot;non&quot;;</span><br><span class="line"></span><br><span class="line">  return function(key)&#123;</span><br><span class="line">    return translations[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line">translate(&quot;yes&quot;); &#x2F;&#x2F;oui</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<h4 id="自增生成器函数"><a href="#自增生成器函数" class="headerlink" title="自增生成器函数"></a>自增生成器函数</h4><p>通过闭包，我们可以创建自增生成器函数。同样，内部状态是私有的。<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/cutk16ps/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function createAGenerate(count, increment) &#123;</span><br><span class="line">  return function()&#123;</span><br><span class="line">    count +&#x3D; increment;</span><br><span class="line">    return count;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">let generateNextNumber &#x3D; createAGenerate(0, 1);</span><br><span class="line">console.log(generateNextNumber()); &#x2F;&#x2F;1</span><br><span class="line">console.log(generateNextNumber()); &#x2F;&#x2F;2</span><br><span class="line">console.log(generateNextNumber()); &#x2F;&#x2F;3</span><br><span class="line">let generateMultipleOfTen &#x3D; createAGenerate(0, 10);</span><br><span class="line">console.log(generateMultipleOfTen()); &#x2F;&#x2F;10</span><br><span class="line">console.log(generateMultipleOfTen()); &#x2F;&#x2F;20</span><br><span class="line">console.log(generateMultipleOfTen()); &#x2F;&#x2F;30</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><em>译者注：原文中依次输出 0,1,2,0,10,20 是有误的，感谢@Round 的指正</em></p>
<h4 id="对象与私有状态"><a href="#对象与私有状态" class="headerlink" title="对象与私有状态"></a>对象与私有状态</h4><p>以上示例中，我们可以创建一个拥有私有状态的函数。同时，我们也可以创建多个拥有同一私有状态的函数。基于此，我们还可以创建一个拥有私有状态的对象。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/zd9Lebg3/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function TodoStore()&#123;</span><br><span class="line">  let todos &#x3D; [];</span><br><span class="line"></span><br><span class="line">  function add(todo)&#123;</span><br><span class="line">    todos.push(todo);</span><br><span class="line">  &#125;</span><br><span class="line">  function get()&#123;</span><br><span class="line">    return todos.filter(isPriorityTodo).map(toTodoViewModel);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function isPriorityTodo(todo)&#123;</span><br><span class="line">     return task.type &#x3D;&#x3D;&#x3D; &quot;RE&quot; &amp;&amp; !task.completed;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function toTodoViewModel(todo) &#123;</span><br><span class="line">     return &#123; id : todo.id, title : todo.title &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return Object.freeze(&#123;</span><br><span class="line">    add,</span><br><span class="line">    get</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>TodoStore()</code> 函数返回了一个拥有私有状态的对象。在外部，我们无法访问私有的 <code>todos</code> 变量，并且 <code>add</code> 和 <code>get</code> 这两个闭包拥有相同的私有状态。在这里，<code>TodoStore()</code> 是一个工厂函数。</p>
<h4 id="闭包-vs-纯函数"><a href="#闭包-vs-纯函数" class="headerlink" title="闭包 vs 纯函数"></a>闭包 vs 纯函数</h4><p>闭包就是那些引用了外部作用域中变量的函数。</p>
<p>为了更好的理解，我们将内部函数拆成闭包和纯函数两个方面：</p>
<ul>
<li>闭包是那些引用了外部作用域中变量的函数。</li>
<li>纯函数是那些没有引用外部作用域中变量的函数，它们通常返回一个值并且没有副作用。</li>
</ul>
<p>在上述例子中，<code>add()</code> 和 <code>get()</code> 函数是闭包，而 <code>isPriorityTodo()</code> 和 <code>toTodoViewModel()</code> 则是纯函数。</p>
<h3 id="闭包在函数式编程中的应用"><a href="#闭包在函数式编程中的应用" class="headerlink" title="闭包在函数式编程中的应用"></a>闭包在函数式编程中的应用</h3><p>闭包在函数式编程中也应用广泛。譬如，<code>underscore</code> 源码中 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://underscorejs.org/#functions">函数相关小节</a> 中的所有函数都利用了闭包这一特性。</p>
<blockquote>
<p>A function decorator is a higher-order function that takes one function as an argument and returns another function, and the returned function is a variation of the argument function —<a target="_blank" rel="noopener external nofollow noreferrer" href="https://leanpub.com/javascript-allonge/read#decorators"> Javascript Allongé</a></p>
</blockquote>
<p>装饰器函数也使用了闭包的特性。</p>
<p>我们来看如下 <code>not</code> 这个简单的装饰器函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function not(fn)&#123;</span><br><span class="line">  return function decorator(...args)&#123;</span><br><span class="line">    return !fn.apply(this, args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>decorator()</code> 函数引用了外部作用域的 fn 变量，因此它是一个闭包。</p>
<p>如果你想知道更多关于装饰器相关的知识，可以查看这篇<a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/here-are-a-few-function-decorators-you-can-write-from-scratch-488549fe8f86">文章</a>。</p>
<h3 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h3><p>在 <code>Javascript</code> 中，局部变量会随着函数的执行完毕而被销毁，除非还有指向他们的引用。当闭包本身也被垃圾回收之后，这些闭包中的私有状态随后也会被垃圾回收。通常我们可以通过切断闭包的引用来达到这一目的。</p>
<p>在这个<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/1j8mhckg/">例子</a>中，我们首先创建了一个 <code>add()</code> 闭包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let add &#x3D; (function createAddClosure()&#123;</span><br><span class="line">    let arr &#x3D; [];</span><br><span class="line">    return function(obj)&#123;</span><br><span class="line">       arr.push(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>随后，我们又定义了两个函数：</p>
<ul>
<li><code>addALotOfObjects()</code> 往闭包变量 <code>arr</code> 中加入对象。</li>
<li><code>clearAllObjects()</code> 将闭包函数置为 <code>null</code> 。</li>
</ul>
<p>并且两个函数皆作为事件处理函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function addALotOfObjects()&#123;</span><br><span class="line">    for(let i&#x3D;1; i&lt;&#x3D;10000;i++) &#123;</span><br><span class="line">       add(new Todo(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function clearAllObjects()&#123;</span><br><span class="line">    if(add)&#123;</span><br><span class="line">       add &#x3D; null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$(&quot;#add&quot;).click(addALotOfObjects);</span><br><span class="line">$(&quot;#clear&quot;).click(clearAllObjects);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>当我点击 <code>Add</code> 按钮时，将往 闭包变量 <code>arr</code> 中加入 10000 个 <code>todo</code> 对象，内存快照如下：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/1/29/16898a684a3f3da2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Memory snapshot after adding 10000 to-dos"></p>
<p>当我点击 <code>Clear</code> 按钮时，我们将闭包引用置为 <code>null</code> 。随后，闭包变量 <code>arr</code> 将被垃圾回收，内存快照如下：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/1/29/16898ab59a0c75bd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Memory snapshot after setting the closure reference to null"></p>
<h3 id="避免全局变量"><a href="#避免全局变量" class="headerlink" title="避免全局变量"></a>避免全局变量</h3><p>在 <code>Javascript</code> 中，我们很容易创建出全局变量。任何定义在函数和 <code>&#123;&#125;</code> 块之外的变量都是全局的，定义在全局作用域中的函数也是全局的。</p>
<p>这里以定义创建不同对象的工厂函数为例。为了避免将所有的工厂函数都放在全局作用域下，最简单的方法就是将他们挂在 <code>app</code> 全局变量下。</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/guhzw5v8/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let app &#x3D; Loader();</span><br><span class="line">app.factory(function DataService(args)&#123; return &#123;&#125;&#125;);</span><br><span class="line">app.factory(function Helper(args)&#123; return &#123;&#125;&#125;);</span><br><span class="line">app.factory(function Mapper(args)&#123; return &#123;&#125;&#125;);</span><br><span class="line">app.factory(function Model(args)&#123;&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>app.factory()</code> 方法还可以将不同的工厂函数归类到不同的模块中。下面这个示例就是将 <code>Timer</code> 工厂函数归类到 <code>tools</code> 模块下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.factory(&quot;tools&quot;)(function Timer(args)&#123; return &#123;&#125;&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p>我们可以在 <code>app</code> 对象上暴露一个 <code>start</code> 方法来作为应用的入口点，通过 回调函数中 <code>factories</code> 参数来访问这些工厂函数。这里 <code>start()</code> 函数只能被调用一次，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.start(function startApplication(factories)&#123;</span><br><span class="line">  let helper &#x3D; factories.Helper();</span><br><span class="line"></span><br><span class="line">  let dataService &#x3D; factories.DataService();</span><br><span class="line">  let model &#x3D; factories.Model(&#123;</span><br><span class="line">      dataService : dataService,</span><br><span class="line">      helper : helper,</span><br><span class="line">      timer : factories.tools.Timer()</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<blockquote>
<p>A Composition Root is a (preferably) unique location in an application where modules are composed together.</p>
<p>Mark Seemann</p>
</blockquote>
<h3 id="loader-对象"><a href="#loader-对象" class="headerlink" title="loader 对象"></a><code>loader</code> 对象</h3><p>让我们来将 <code>app</code> 完善为一个 <code>loader</code> 对象，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://jsfiddle.net/cristi_salcescu/6ahpbxy0/">示例</a>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">function Loader()&#123;</span><br><span class="line">  let modules &#x3D; Object.create(null);</span><br><span class="line">  let started &#x3D; false;</span><br><span class="line"></span><br><span class="line">  function getNamespaceModule(modulesText)&#123;</span><br><span class="line">    let parent &#x3D; modules;</span><br><span class="line">    if(modulesText)&#123;</span><br><span class="line">      let parts &#x3D; modulesText.split(&#39;.&#39;);</span><br><span class="line">      for(let i&#x3D;0; i&lt;parts.length; i++)&#123;</span><br><span class="line">        let part &#x3D; parts[i];</span><br><span class="line">        if (typeof parent[part] &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;</span><br><span class="line">          parent[part] &#x3D; Object.create(null);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        parent &#x3D; parent[part];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return parent;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function addFunction(namespace, fn)&#123;</span><br><span class="line">    if(typeof(fn) !&#x3D;&#x3D; &quot;function&quot;) &#123;</span><br><span class="line">      throw &quot;Only functions can be added&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    let module &#x3D; getNamespaceModule(namespace);</span><br><span class="line">    let fnName &#x3D; fn.name;</span><br><span class="line">    module[fnName] &#x3D; fn;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function addNamespace(namespace)&#123;</span><br><span class="line">    return function(fn)&#123;</span><br><span class="line">      addFunction(namespace, fn)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function factory()&#123;</span><br><span class="line">    if(typeof(arguments[0]) &#x3D;&#x3D;&#x3D; &quot;string&quot;)&#123;</span><br><span class="line">      return addNamespace(arguments[0]);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return addFunction(null, arguments[0]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function start(startApplication)&#123;</span><br><span class="line">    if(started)&#123;</span><br><span class="line">      throw &quot;App can be started only once&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    startApplication(Object.freeze(modules));</span><br><span class="line">    started &#x3D; true;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return Object.freeze(&#123;</span><br><span class="line">    factory,</span><br><span class="line">    start</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">let app &#x3D; Loader();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>
<p><code>factory()</code> 方法用于添加新的工厂函数到内部变量 <code>modules</code> 中。</p>
<p><code>start()</code> 方法则会调用回调函数，在回调函数中访问内部变量。</p>
<p>通过 <code>factory()</code> 定义工厂函数，将 <code>start()</code> 作为整个应用中调用各种工厂函数生成不同对象的唯一入口点，这是如此简洁优雅的方式。</p>
<p>在这里，<code>factory</code> 和 <code>start</code> 都是闭包。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>闭包是一个可以访问外部作用域中变量的内部函数。</p>
<p>这些被引用的变量直到闭包被销毁时才会被销毁。</p>
<p>闭包使得 <code>timer</code> 定时器，事件处理，<code>AJAX</code> 请求等异步任务更加容易。</p>
<p>可以通过闭包来达到封装性。</p>
<p>最后，想获得更多关于 <code>Javascript</code> 函数相关知识，可以查看以下文章：</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/discover-functional-programming-in-javascript-with-this-thorough-introduction-a2ad9af2d645">Discover Functional Programming in JavaScript with this thorough introduction</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/discover-the-power-of-first-class-functions-fd0d7b599b69">Discover the power of first class functions</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/how-point-free-composition-will-make-you-a-better-functional-programmer-33dcb910303a">How point-free composition will make you a better functional programmer</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/here-are-a-few-function-decorators-you-can-write-from-scratch-488549fe8f86">Here are a few function decorators you can write from scratch</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.freecodecamp.org/make-your-code-easier-to-read-with-functional-programming-94fb8cc69f9d">Make your code easier to read with Functional Programming</a></p>
<link rel="stylesheet" href="/styles/index.css">
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/js/">js</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/05/13/js/selfTest/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">自检清单</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/05/10/%E8%A1%8C%E6%94%BF%E7%AE%A1%E7%90%86/WesternPoliticalSystem/%E6%80%BB%E7%BB%93/"><span class="level-item">00316西方政治制度</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="SOHUCS" sid="2021/05/13/js/closure/"></div><script charset="utf-8" src="https://changyan.sohu.com/upload/changyan.js"></script><script>window.changyan.api.config({appid: 'cyvf8qdnv',conf: '81e7eedb51850a20f9b383d2ba64740c'});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#作用域"><span class="level-left"><span class="level-item">作用域</span></span></a></li><li><a class="level is-mobile" href="#嵌套作用域"><span class="level-left"><span class="level-item">嵌套作用域</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#外部函数作用域"><span class="level-left"><span class="level-item">外部函数作用域</span></span></a></li><li><a class="level is-mobile" href="#外部块作用域"><span class="level-left"><span class="level-item">外部块作用域</span></span></a></li></ul></li><li><a class="level is-mobile" href="#词法作用域"><span class="level-left"><span class="level-item">词法作用域</span></span></a></li><li><a class="level is-mobile" href="#作用域链"><span class="level-left"><span class="level-item">作用域链</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#外部作用域执行完毕后"><span class="level-left"><span class="level-item">外部作用域执行完毕后</span></span></a></li><li><a class="level is-mobile" href="#Timer"><span class="level-left"><span class="level-item">Timer</span></span></a></li><li><a class="level is-mobile" href="#Event"><span class="level-left"><span class="level-item">Event</span></span></a></li><li><a class="level is-mobile" href="#Ajax"><span class="level-left"><span class="level-item">Ajax</span></span></a></li></ul></li><li><a class="level is-mobile" href="#闭包与循环"><span class="level-left"><span class="level-item">闭包与循环</span></span></a></li><li><a class="level is-mobile" href="#闭包与封装性"><span class="level-left"><span class="level-item">闭包与封装性</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#函数与私有状态"><span class="level-left"><span class="level-item">函数与私有状态</span></span></a></li><li><a class="level is-mobile" href="#工厂模式与私有原型对象"><span class="level-left"><span class="level-item">工厂模式与私有原型对象</span></span></a></li><li><a class="level is-mobile" href="#工厂模式与私有构造函数"><span class="level-left"><span class="level-item">工厂模式与私有构造函数</span></span></a></li><li><a class="level is-mobile" href="#翻译功能与私有-map"><span class="level-left"><span class="level-item">翻译功能与私有 map</span></span></a></li><li><a class="level is-mobile" href="#自增生成器函数"><span class="level-left"><span class="level-item">自增生成器函数</span></span></a></li><li><a class="level is-mobile" href="#对象与私有状态"><span class="level-left"><span class="level-item">对象与私有状态</span></span></a></li><li><a class="level is-mobile" href="#闭包-vs-纯函数"><span class="level-left"><span class="level-item">闭包 vs 纯函数</span></span></a></li></ul></li><li><a class="level is-mobile" href="#闭包在函数式编程中的应用"><span class="level-left"><span class="level-item">闭包在函数式编程中的应用</span></span></a></li><li><a class="level is-mobile" href="#垃圾回收"><span class="level-left"><span class="level-item">垃圾回收</span></span></a></li><li><a class="level is-mobile" href="#避免全局变量"><span class="level-left"><span class="level-item">避免全局变量</span></span></a></li><li><a class="level is-mobile" href="#loader-对象"><span class="level-left"><span class="level-item">loader 对象</span></span></a></li><li><a class="level is-mobile" href="#总结"><span class="level-left"><span class="level-item">总结</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/http/"><span class="tag">http</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js/"><span class="tag">js</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js-%E9%80%BB%E8%BE%91%E9%A2%98/"><span class="tag">js_逻辑题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redux/"><span class="tag">redux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue/"><span class="tag">vue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/websocket/"><span class="tag">websocket</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%AD%E5%9B%BD%E6%94%BF%E6%B2%BB%E5%88%B6%E5%BA%A6/"><span class="tag">中国政治制度</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%AC%E5%85%B1%E6%94%BF%E7%AD%96/"><span class="tag">公共政策</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%AC%E5%8A%A1%E5%91%98%E5%88%B6%E5%BA%A6/"><span class="tag">公务员制度</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%B6%E4%BB%96/"><span class="tag">其他</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="tag">小程序</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A4%BE%E4%BC%9A%E5%AD%A6/"><span class="tag">社会学</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE/"><span class="tag">配置</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">40</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">六月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">一月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/07/"><span class="level-start"><span class="level-item">七月 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://es6.ruanyifeng.com/" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">ES6教程</span></span><span class="level-right"><span class="level-item tag">es6.ruanyifeng.com</span></span></a></li><li><a class="level is-mobile" href="https://react.html.cn/" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">React</span></span><span class="level-right"><span class="level-item tag">react.html.cn</span></span></a></li><li><a class="level is-mobile" href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">Typescript</span></span><span class="level-right"><span class="level-item tag">www.tslang.cn</span></span></a></li><li><a class="level is-mobile" href="https://www.iconfont.cn/" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">iconfont</span></span><span class="level-right"><span class="level-item tag">www.iconfont.cn</span></span></a></li><li><a class="level is-mobile" href="https://dvajs.com/" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">Dva</span></span><span class="level-right"><span class="level-item tag">dvajs.com</span></span></a></li><li><a class="level is-mobile" href="https://taro-docs.jd.com/taro/docs/apis/about/desc" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">Taro</span></span><span class="level-right"><span class="level-item tag">taro-docs.jd.com</span></span></a></li><li><a class="level is-mobile" href="https://panjiachen.gitee.io/vue-element-admin-site/zh/" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">vue-element-admin</span></span><span class="level-right"><span class="level-item tag">panjiachen.gitee.io</span></span></a></li><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener external nofollow noreferrer"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://scott_xia.gitee.io/static-resources/img/header.jpg" alt="Scott_xia"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Scott_xia</p><p class="is-size-6 is-block">Web Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>AnHui HeFei</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">79</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">16</p></a></div></div></nav></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/css/"><span class="level-start"><span class="level-item">css</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/html/"><span class="level-start"><span class="level-item">html</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/http/"><span class="level-start"><span class="level-item">http</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/js/"><span class="level-start"><span class="level-item">js</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/react/"><span class="level-start"><span class="level-item">react</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile" href="/categories/script/"><span class="level-start"><span class="level-item">script</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/vue/"><span class="level-start"><span class="level-item">vue</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/webpack/"><span class="level-start"><span class="level-item">webpack</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%85%B6%E4%BB%96/"><span class="level-start"><span class="level-item">其他</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"><span class="level-start"><span class="level-item">小程序</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%A1%8C%E6%94%BF%E7%AE%A1%E7%90%86/"><span class="level-start"><span class="level-item">行政管理</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%85%8D%E7%BD%AE/"><span class="level-start"><span class="level-item">配置</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2021/12/13/js/gitcommit/"><img src="/images/bgi/snow.jpg" alt="git Commit"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-13T02:51:54.000Z">2021-12-13</time></p><p class="title"><a href="/2021/12/13/js/gitcommit/">git Commit</a></p><p class="categories"><a href="/categories/js/">js</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/09/07/typesctipt/ts_uitls/"><img src="/images/bgi/bluebg.jpg" alt="ts_泛型工具"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-09-07T07:59:55.000Z">2021-09-07</time></p><p class="title"><a href="/2021/09/07/typesctipt/ts_uitls/">ts_泛型工具</a></p><p class="categories"><a href="/categories/%E5%85%B6%E4%BB%96/">其他</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/09/02/js/d3/"><img src="/images/bgi/greenVue.jpg" alt="d3入门"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-09-02T04:01:28.000Z">2021-09-02</time></p><p class="title"><a href="/2021/09/02/js/d3/">d3入门</a></p><p class="categories"><a href="/categories/js/">js</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/08/30/js/generator/"><img src="/images/bgi/code.jpg" alt="Generator"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-08-30T08:05:11.000Z">2021-08-30</time></p><p class="title"><a href="/2021/08/30/js/generator/">Generator</a></p><p class="categories"><a href="/categories/js/">js</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/08/30/react/utils/"><img src="/images/bgi/book2.jpg" alt="utils"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-08-30T05:18:46.000Z">2021-08-30</time></p><p class="title"><a href="/2021/08/30/react/utils/">utils</a></p><p class="categories"><a href="/categories/js/">js</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://scott_xia.gitee.io/static-resources/img/header.jpg" alt="Scott&#039;s blog" height="28"></a><p class="is-size-7"><span>&copy; 2022 Scott_xia</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener external nofollow noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener external nofollow noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener external nofollow noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener external nofollow noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener external nofollow noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;" rel="external nofollow noreferrer">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="https://cdn.staticfile.org/jquery/1.10.2/jquery.js"></script><script type="text/javascript" src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script><script type="text/javascript" color="34,139,34" opacity="0.7" zIndex="-2" count="50" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>